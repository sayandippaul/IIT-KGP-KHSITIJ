<!DOCTYPE html>
<!-- Created By CodingNepal -->
<html lang="en" dir="ltr">
   <head>
      <meta charset="utf-8">
      <meta name="google-signin-client_id" content="31628992962-u8rfhl4f69tt6g13q89dojpsj0feqp87.apps.googleusercontent.com">
      <title>Transparent Login Form HTML CSS</title>
      {{!-- <link rel="stylesheet" href="style.css"> --}}
      <style>
         @import url('https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700|Poppins:400,500&display=swap');
*{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  user-select: none;
}
.bg-img{
  background: url('https://images.unsplash.com/photo-1572509018340-1fc13b5df491?q=80&w=1000&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8bGFwdG9wJTIwZGFya3xlbnwwfHwwfHx8MA%3D%3D');

  height: 100vh;
  background-size: cover;
  background-position: center;
}
.bg-img:after{
  position: absolute;
  content: '';
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  background: rgba(0,0,0,0.7);
}
.content{
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 999;
  text-align: center;
  padding: 60px 32px;
  width: 370px;
  transform: translate(-50%,-50%);
  background: rgba(255,255,255,0.04);
  box-shadow: -1px 4px 28px 0px rgba(0,0,0,0.75);
}
.content header{
  color: white;
  font-size: 33px;
  font-weight: 600;
  margin: 0 0 35px 0;
  font-family: 'Montserrat',sans-serif;
}
.field{
  position: relative;
  height: 45px;
  width: 100%;
  display: flex;
  background: rgba(255,255,255,0.94);
}
.field span{
  color: #222;
  width: 40px;
  line-height: 45px;
}
.field input{
  height: 100%;
  width: 100%;
  background: transparent;
  border: none;
  outline: none;
  color: #222;
  font-size: 16px;
  font-family: 'Poppins',sans-serif;
}
.space{
  margin-top: 16px;
}
.show{
  position: absolute;
  right: 13px;
  font-size: 13px;
  font-weight: 700;
  color: #222;
  display: none;
  cursor: pointer;
  font-family: 'Montserrat',sans-serif;
}
.pass-key:valid ~ .show{
  display: block;
}
.pass{
  text-align: left;
  margin: 10px 0;
}
.pass a{
  color: white;
  text-decoration: none;
  font-family: 'Poppins',sans-serif;
}
.pass:hover a{
  text-decoration: underline;
}
.field input[type="submit"]{
  background: #3498db;
  border: 1px solid #2691d9;
  color: white;
  font-size: 18px;
  letter-spacing: 1px;
  font-weight: 600;
  cursor: pointer;
  font-family: 'Montserrat',sans-serif;
}
.field input[type="submit"]:hover{
  background: #2691d9;
}
.login{
  color: white;
  margin: 20px 0;
  font-family: 'Poppins',sans-serif;
}
.links{
  display: flex;
  cursor: inherit;
  color: black;
  margin: 0 0 20px 0;
}
.facebook,.instagram{
  width: 100%;
  height: 45px;
  line-height: 45px;
  margin-left: 20px;
}
.facebook{
  margin-left: 0;
  background: #4267B2;
  border: 1px solid #3e61a8;
}
.instagram{
  background: #E1306C;
  border: 1px solid #df2060;
}
.facebook:hover{
  background: #3e61a8;
}
.instagram:hover{
  background: #df2060;
}
.links i{
  font-size: 17px;
}
i span{
  margin-left: 8px;
  font-weight: 500;
  letter-spacing: 1px;
  font-size: 16px ;
  font-family: 'poppins',sans-serif;
}
.signup{
  font-size: 15px;
  color: white;
  font-family: 'Poppins',sans-serif;
}
.signup a{
  color: red;
  text-decoration: none;
}
.signup a:hover{
  text-decoration: underline;
}
      </style>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
   </head>
   <body onload="init()">
       <script src="https://apis.google.com/js/platform.js" async defer></script>
      <script src="https://accounts.google.com/gsi/client" async></script>
      <div class="bg-img">
         <div class="content">
            <header>Login Form</header>
            <form onsubmit="submitd(0)">
               <div class="field">
                  <span class="fa fa-user"></span>
                  <input type="text" id="email" name="email"  required placeholder="Email">
               </div>
               <div class="field space">
                  <span class="fa fa-lock"></span>
                  <input type="password" id="pass" name="pass" class="pass-key" required placeholder="Password">
                  <span class="show">SHOW</span>
               </div>
               <div class="pass">
                  <a  onclick="sendmailforgotpassword()">Forgot Password?</a>
               </div>
               <div class="field">
                  <input type="submit" value="LOGIN">
               </div>
            </form>
            <div class="login">
               Or login with
            </div>
            <div class="links">
               <div class="instagram" onclick="init()">
                  <i class="fab fa-google"><span>Google</span></i>
               </div>
               </div>
              
              {{!-- <div class="g-signin2" data-onsuccess="" data-ux_mode="popup"
    data-auto_prompt="true" ></div>
            </div>
    <div class="g_id_signout" style="background-color: aliceblue;">Sign Out</div> --}}
            <div class="signup">
               Don't have account?
               <a href="register">Signup Now</a>
            </div>
         </div>
      </div>
      
      <script>
{{!-- 
 function getCookie(cName) {
  const name = cName + "=";
  const cDecoded = decodeURIComponent(document.cookie); //to be careful
  const cArr = cDecoded.split('; ');
  let res;
  cArr.forEach(val => {
    if (val.indexOf(name) === 0) res = val.substring(name.length);
  })
  return res
}
console.log("hi"+getCookie("g_state")); --}}

function setCookie() {
        document.cookie = 'g_state = {"i_l":0}' ;
}
setCookie();
    

        function handleCredentialResponse(response){
          console.log(response);
          if(response.credential){
            let jwt=response.credential;
            let user=JSON.parse(atob(jwt.split(".")[1]));
            console.log(user.email)
            
ds={ pass:"",email:user.email,value:1 };
          submitd(1);
          }
        }

        function init(){
setCookie();

          google.accounts.id.initialize({
            client_id:"31628992962-m5n46j7rb9to747vgnufnn0ks2clb3je.apps.googleusercontent.com",
            auto_select:false,
            callback:handleCredentialResponse
          })
          google.accounts.id.prompt()

        }

        {{!-- function handleCredentialResponse(response) {
     // decodeJwtResponse() is a custom function defined by you
     // to decode the credential response.
     const responsePayload = decodeJwtResponse(response.credential);

     console.log("ID: " + responsePayload.sub);
     console.log('Full Name: ' + responsePayload.name);
     console.log('Given Name: ' + responsePayload.given_name);
     console.log('Family Name: ' + responsePayload.family_name);
     console.log("Image URL: " + responsePayload.picture);
     console.log("Email: " + responsePayload.email);
  }
         const pass_field = document.querySelector('.pass-key');
         const showBtn = document.querySelector('.show');
         showBtn.addEventListener('click', function(){
          if(pass_field.type === "password"){
            pass_field.type = "text";
            showBtn.textContent = "HIDE";
            showBtn.style.color = "#3498db";
          }else{
            pass_field.type = "password";
            showBtn.textContent = "SHOW";
            showBtn.style.color = "#222";
          }
         }); --}}
var ds={ pass:"",email:"",value:"" };
           function submitd(k){
            event.preventDefault();
            if(k==0){

            var email=document.getElementById("email").value;
            var pass=document.getElementById("pass").value;

                ds = { pass:pass,email:email,value:k };
            }
      console.log(ds);
            //var name=document.getElementById("name").value;

    fetch(url+"/loginuser", {
      method: "POST",
      headers: {
        Accept: "application/json",
        "Content-Type": "application/json",
        "Access-Control-Allow-Headers": "Content-Type",
        "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
        "Access-Control-Allow-Origin": "*",
      },
      body: JSON.stringify(ds),
    })

      .then((res) => res.json())
      .then((data) => {
         console.log(data);
      if(data!=null && data!=undefined){

      alert("welcome "+data.username); localStorage.setItem("username",data.username);
      localStorage.setItem("email",data.email);
      localStorage.setItem("about",data.about);
      localStorage.setItem("userid",data.userid);
      localStorage.setItem("dp",data.dp);

      localStorage.setItem("scrollvalue",1);
      localStorage.setItem("soundvalue",1);
     console.log(data);
      window.location.replace("contact");
      }
      else{
         alert("wrong credentials");
         //window.location.replace("login");
      }

      })
      .catch((err) => console.log(err));
    
}


     function isloggedin(){
      var l=localStorage.getItem("userid");

      if( l=="null" ){

      }
      else{
        window.location.replace("contact");
      }
     } 
     isloggedin();   




{{!-- 
function onSignIn(googleUser) {
  var profile = googleUser.getBasicProfile();
  alert("hi");
  console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
  console.log('Name: ' + profile.getName());
  console.log('Image URL: ' + profile.getImageUrl());
  console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
} --}}
{{!-- const button = document.getElementById('signout_button');
button.onclick = () => {
  google.accounts.id.disableAutoSelect();
} --}}


var url="http://localhost:3000";
function sendmailforgotpassword() {
            var email=document.getElementById("email").value;
            if(email.trim()!=""){
              alert("password sent to your registered email id");

            

      fetch(url+"/sendmailforgotpassword", {
        method: "POST",
        headers: {
          Accept: "application/json",
          "Content-Type": "application/json",
          "Access-Control-Allow-Headers": "Content-Type",
          "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
          "Access-Control-Allow-Origin": "*",
        },
        body: JSON.stringify({email:email}),
      })
        .then((res) => res.json())
        .then((data) => { })
        .catch((err) => console.log(err));
            }
            else{
              alert("enter email id");
            }
    }

      </script>
   </body>
</html>